<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>How I Built My Own Ad-Blocking DNS Server in the Cloud (2025 Updated Edition!) | Prajwol Bikram Adhikari</title>
<meta name="keywords" content="AdGuard, CloudComputing, AWS, EC2, Firewall, Elastic IP, LetsEncrypt, Certbot, Debian, No-IP, SSL, TLS, Cron, DNS, DoH, DoT, DNSSEC">
<meta name="description" content="Your Personal Internet Guardian: How to Build a FREE Ad-Blocker in the Cloud! üöÄ
Hey everyone! A while back, I wrote a guide on setting up AdGuard Home on Linode. The world of tech moves fast, and it&rsquo;s time for an upgrade! Today, we&rsquo;re going to build our own powerful, network-wide ad-blocker using Amazon Web Services (AWS), and we&rsquo;ll make it secure with our own domain and SSL certificate.
Think of this as building a digital gatekeeper for your internet. Before any ads, trackers, or malicious sites can reach your devices, our AdGuard Home server will slam the door shut. The best part? This works on your phone, laptop, smart TV‚Äîanything on your network‚Äîwithout installing a single app on them.">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/projects/adguard-updated/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.8e159e62f02d7d4d5f548c516c00a4346c80759206bcad8dd5461667130fd389.css" integrity="sha256-jhWeYvAtfU1fVIxRbACkNGyAdZIGvK2N1UYWZxMP04k=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.2eadbb982468c11a433a3e291f01326f2ba43f065e256bf792dbd79640a92316.js" integrity="sha256-Lq27mCRowRpDOj4pHwEybyukPwZeJWv3ktvXlkCpIxY="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/projects/adguard-updated/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="How I Built My Own Ad-Blocking DNS Server in the Cloud (2025 Updated Edition!)" />
<meta property="og:description" content="Your Personal Internet Guardian: How to Build a FREE Ad-Blocker in the Cloud! üöÄ
Hey everyone! A while back, I wrote a guide on setting up AdGuard Home on Linode. The world of tech moves fast, and it&rsquo;s time for an upgrade! Today, we&rsquo;re going to build our own powerful, network-wide ad-blocker using Amazon Web Services (AWS), and we&rsquo;ll make it secure with our own domain and SSL certificate.
Think of this as building a digital gatekeeper for your internet. Before any ads, trackers, or malicious sites can reach your devices, our AdGuard Home server will slam the door shut. The best part? This works on your phone, laptop, smart TV‚Äîanything on your network‚Äîwithout installing a single app on them." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/projects/adguard-updated/" />
<meta property="og:image" content="http://localhost:1313/projects/adguard-linode/adguard_aws.webp" /><meta property="article:section" content="projects" />



<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://localhost:1313/projects/adguard-linode/adguard_aws.webp" />
<meta name="twitter:title" content="How I Built My Own Ad-Blocking DNS Server in the Cloud (2025 Updated Edition!)"/>
<meta name="twitter:description" content="Your Personal Internet Guardian: How to Build a FREE Ad-Blocker in the Cloud! üöÄ
Hey everyone! A while back, I wrote a guide on setting up AdGuard Home on Linode. The world of tech moves fast, and it&rsquo;s time for an upgrade! Today, we&rsquo;re going to build our own powerful, network-wide ad-blocker using Amazon Web Services (AWS), and we&rsquo;ll make it secure with our own domain and SSL certificate.
Think of this as building a digital gatekeeper for your internet. Before any ads, trackers, or malicious sites can reach your devices, our AdGuard Home server will slam the door shut. The best part? This works on your phone, laptop, smart TV‚Äîanything on your network‚Äîwithout installing a single app on them."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Projects",
      "item": "http://localhost:1313/projects/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "How I Built My Own Ad-Blocking DNS Server in the Cloud (2025 Updated Edition!)",
      "item": "http://localhost:1313/projects/adguard-updated/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "How I Built My Own Ad-Blocking DNS Server in the Cloud (2025 Updated Edition!)",
  "name": "How I Built My Own Ad-Blocking DNS Server in the Cloud (2025 Updated Edition!)",
  "description": "Your Personal Internet Guardian: How to Build a FREE Ad-Blocker in the Cloud! üöÄ Hey everyone! A while back, I wrote a guide on setting up AdGuard Home on Linode. The world of tech moves fast, and it\u0026rsquo;s time for an upgrade! Today, we\u0026rsquo;re going to build our own powerful, network-wide ad-blocker using Amazon Web Services (AWS), and we\u0026rsquo;ll make it secure with our own domain and SSL certificate.\nThink of this as building a digital gatekeeper for your internet. Before any ads, trackers, or malicious sites can reach your devices, our AdGuard Home server will slam the door shut. The best part? This works on your phone, laptop, smart TV‚Äîanything on your network‚Äîwithout installing a single app on them.\n",
  "keywords": [
    "AdGuard", "CloudComputing", "AWS", "EC2", "Firewall", "Elastic IP", "LetsEncrypt", "Certbot", "Debian", "No-IP", "SSL", "TLS", "Cron", "DNS", "DoH", "DoT", "DNSSEC"
  ],
  "articleBody": "Your Personal Internet Guardian: How to Build a FREE Ad-Blocker in the Cloud! üöÄ Hey everyone! A while back, I wrote a guide on setting up AdGuard Home on Linode. The world of tech moves fast, and it‚Äôs time for an upgrade! Today, we‚Äôre going to build our own powerful, network-wide ad-blocker using Amazon Web Services (AWS), and we‚Äôll make it secure with our own domain and SSL certificate.\nThink of this as building a digital gatekeeper for your internet. Before any ads, trackers, or malicious sites can reach your devices, our AdGuard Home server will slam the door shut. The best part? This works on your phone, laptop, smart TV‚Äîanything on your network‚Äîwithout installing a single app on them.\nThis guide is for everyone, from seasoned tech wizards to curious beginners. We‚Äôll break down every step in simple terms, so grab a coffee, and let‚Äôs build something awesome!\n## Chapter 1: Building Our Home in the AWS Cloud ‚òÅÔ∏è First, we need a server. We‚Äôll use an Amazon EC2 instance, which is just a fancy name for a virtual computer that you rent.\nSign Up for AWS: If you don‚Äôt have an account, head to the AWS website and sign up. You‚Äôll need a credit card for verification, but for this guide, we can often stay within the Free Tier.\nLaunch Your EC2 Instance:\nLog in to your AWS Console and search for EC2. Click ‚ÄúLaunch instance‚Äù. Name: Give your server a cool name, like AdGuard-Server. Application and OS Images: In the search bar, type Debian and select the latest version (e.g., Debian 12). Make sure it‚Äôs marked ‚ÄúFree tier eligible‚Äù. Instance Type: Choose t2.micro. This is your free, trusty little server. Key Pair (for login): This is your digital key to the server‚Äôs front door. Click ‚ÄúCreate a new key pair‚Äù, name it something like my-adguard-key, and download the .pem file. Keep this file secret and safe! Network settings (The Firewall): This is crucial. We need to tell our server which doors to open. Click ‚ÄúEdit‚Äù. Check the box for ‚ÄúAllow SSH traffic from‚Äù and select My IP. This lets you securely log in. Check ‚ÄúAllow HTTPS traffic from the internet‚Äù and ‚ÄúAllow HTTP traffic from the internet‚Äù. We‚Äôll need these for our secure dashboard later. Launch It! Hit the ‚ÄúLaunch instance‚Äù button and watch as your new cloud server comes to life.\nGive Your Server a Permanent Address (Elastic IP):\nBy default, your server‚Äôs public IP address will change every time it reboots. Let‚Äôs make it permanent! In the EC2 menu on the left, go to ‚ÄúElastic IPs‚Äù. Click ‚ÄúAllocate Elastic IP address‚Äù and then ‚ÄúAllocate‚Äù. Select the new IP address from the list, click ‚ÄúActions‚Äù, and then ‚ÄúAssociate Elastic IP address‚Äù. Choose your AdGuard-Server instance from the list and click ‚ÄúAssociate‚Äù. Your server now has a static IP address that will never change! Make a note of this new IP. ## Chapter 2: Opening the Doors (Configuring the Firewall) üö™ Our server is running, but we need to open a few more specific doors for AdGuard Home to work.\nGo to your EC2 Instance details, click the ‚ÄúSecurity‚Äù tab, and click on the Security Group name. Click ‚ÄúEdit inbound rules‚Äù and ‚ÄúAdd rule‚Äù for each of the following: Port 3000: Custom TCP, Port 3000, Source My IP. (For the initial setup). Port 53 (TCP): Custom TCP, Port 53, Source Anywhere-IPv4. (For DNS). Port 53 (UDP): Custom UDP, Port 53, Source Anywhere-IPv4. (Also for DNS). Port 853: Custom TCP, Port 853, Source Anywhere-IPv4. (For DNS-over-TLS). Click ‚ÄúSave rules‚Äù. Your firewall is now ready! ## Chapter 3: Installing AdGuard Home üõ°Ô∏è Now, let‚Äôs connect to our server and install the magic software.\nConnect via SSH: Open a terminal (PowerShell on Windows, Terminal on Mac/Linux) and use the key you downloaded to connect. Use your new Elastic IP address! # Replace the path and Elastic IP with your own ssh -i \"path/to/my-adguard-key.pem\" admin@YOUR_ELASTIC_IP Install AdGuard Home: Run this one simple command. It downloads and installs everything for you. curl -s -S -L [https://raw.githubusercontent.com/AdguardTeam/AdGuardHome/master/scripts/install.sh](https://raw.githubusercontent.com/AdguardTeam/AdGuardHome/master/scripts/install.sh) | sh -s -- -v Run the Setup Wizard: The script will give you a link, like http://YOUR_ELASTIC_IP:3000. Open this in your browser. Follow the on-screen steps to create your admin username and password. ## Chapter 4: Teaching Your Guardian Who to Trust and What to Block With AdGuard Home installed, the next step is to configure its core brain: the DNS servers it gets its answers from and the blocklists it uses to protect your network.\n1. Setting Up Upstream DNS Servers Think of ‚ÄúUpstream DNS Servers‚Äù as the giant, public phonebooks of the internet. When your AdGuard server doesn‚Äôt know an address (and it‚Äôs not on a blocklist), it asks one of these upstreams. It‚Äôs recommended to use a mix of the best encrypted DNS providers for security, privacy, and speed.\nIn the AdGuard dashboard, go to Settings -\u003e DNS settings. In the ‚ÄúUpstream DNS servers‚Äù box, enter the following, one per line:\nhttps://dns.quad9.net/dns-query https://dns.google/dns-query https://dns.cloudflare.com/dns-query Quad9: Focuses heavily on security, blocking malicious domains. Google: Known for being very fast. Cloudflare: A great all-around choice with a strong focus on privacy. 2. Optimizing DNS Performance Still in the DNS settings page, scroll down to optimize how your server queries the upstreams.\nParallel requests: Select this option. This is the fastest and most resilient mode. It sends your DNS query to all three of your upstream servers at the same time and uses the answer from the very first one that responds. This ensures you always get the quickest possible result.\nEnable EDNS client subnet (ECS): Check this box. This is very important for services like Netflix, YouTube, and other content delivery networks (CDNs). It helps them give you content from a server that is geographically closest to you, resulting in faster speeds and a better experience.\n3. Enabling DNSSEC Right below the upstream servers, there‚Äôs a checkbox for ‚ÄúEnable DNSSEC‚Äù. You should check this box. DNSSEC is like a digital wax seal on a letter; it verifies that the DNS answers you‚Äôre getting are authentic and haven‚Äôt been tampered with. It‚Äôs a simple, one-click security boost.\n4. Choosing Your Blocklists This is the fun part‚Äîthe actual ad-blocking! Go to Filters -\u003e DNS blocklists. For a ‚ÄúBalanced \u0026 Powerful‚Äù setup that blocks aggressively without a high risk of breaking websites, enable the following lists:\nAdGuard DNS filter: A great, well-maintained baseline. OISD Blocklist Big: Widely considered one of the best all-in-one lists for blocking ads, trackers, and malware. HaGeZi‚Äôs Pro Blocklist: A fantastic list that adds another layer of aggressive blocking for privacy. HaGeZi‚Äôs Threat Intelligence Feed: A crucial security-only list that focuses on protecting against active threats like phishing and malware. This combination will give you robust protection against both annoyances and real dangers.\n## Chapter 5: Giving Your Server a Name (Free Domain with No-IP) üìõ An IP address is hard to remember. Let‚Äôs get a free, memorable name for our server.\nSign Up at No-IP: Go to No-IP.com, create a free account, and create a hostname (e.g., my-dns.ddns.net). Point it to Your Server: When creating the hostname, enter your server‚Äôs permanent Elastic IP address. Confirm your account via email. ## Chapter 6: Making It Secure with SSL/TLS üîê We‚Äôll use Let‚Äôs Encrypt and Certbot to get a free SSL certificate, which lets us use secure https:// and encrypted DNS.\nInstall Certbot: In your SSH session, run these commands:\nsudo apt update sudo apt install certbot -y Get the Certificate: Run this command, replacing the email and domain with your own.\n# This command will temporarily stop any service on port 80, get the certificate, and then finish. sudo certbot certonly --standalone --agree-tos --email YOUR_EMAIL@example.com -d your-no-ip-hostname.ddns.net If it‚Äôs successful, it will tell you where your certificate files are saved (usually in /etc/letsencrypt/live/your-no-ip-hostname.ddns.net/).\nConfigure AdGuard Home Encryption:\nGo to your AdGuard Home dashboard (Settings -\u003e Encryption settings). Check ‚ÄúEnable encryption‚Äù. In the ‚ÄúServer name‚Äù field, enter your No-IP hostname. Under ‚ÄúCertificates‚Äù, choose ‚ÄúSet a certificates file path‚Äù. Certificate path: /etc/letsencrypt/live/your-no-ip-hostname.ddns.net/fullchain.pem Private key path: /etc/letsencrypt/live/your-no-ip-hostname.ddns.net/privkey.pem Click ‚ÄúSave configuration‚Äù. The page will reload on a secure https:// connection! ## Chapter 7: Automating SSL Renewal (Cron Job Magic) ‚ú® Let‚Äôs Encrypt certificates last for 90 days. We can tell our server to automatically renew them.\nOpen the Cron Editor: In SSH, run sudo crontab -e and choose nano as your editor. Add the Renewal Job: Add this line to the bottom of the file. It tells the server to try renewing the certificate every day at 2:30 AM. 30 2 * * * systemctl stop AdGuardHome.service \u0026\u0026 certbot renew --quiet \u0026\u0026 systemctl start AdGuardHome.service Save and exit (Ctrl+X, then Y, then Enter). Your server will now keep its certificate fresh forever! ## Chapter 8: Testing Your New Superpowers (DoH \u0026 DoT) üß™ For a direct confirmation, I used these commands on my computer:\nDNS-over-HTTPS (DoH) Test: This test checks if the secure web endpoint for DNS is alive.\ncurl -v [https://your-no-ip-hostname.ddns.net/dns-query](https://your-no-ip-hostname.ddns.net/dns-query) I got a ‚Äú405 Method Not Allowed‚Äù error, which sounds bad but is actually great news. It means I successfully connected to the server, which correctly told me I didn‚Äôt send a real query. The connection works!\nDNS-over-TLS (DoT) Test: This checks the dedicated secure port for DNS. I used a tool called kdig.\n# I had to install it first with: sudo apt install knot-dnsutils kdig @your-no-ip-hostname.ddns.net +tls-ca +tls-host=your-no-ip-hostname.ddns.net example.com The command returned a perfect DNS answer for example.com, confirming the secure tunnel was working.\n## Chapter 9: Protecting Your Kingdom (Router \u0026 Phone Setup) üè∞ Now, let‚Äôs point your devices to their new guardian.\nOn Your Home Router: Log in to your router‚Äôs admin page, find the DNS settings, and enter your server‚Äôs Elastic IP as the primary DNS server. Leave the secondary field blank! This forces all devices on your Wi-Fi to be protected. Then, restart your router. On Your Mobile Phone: Android: Go to Settings -\u003e Network -\u003e Private DNS. Choose ‚ÄúPrivate DNS provider hostname‚Äù and enter your No-IP hostname (my-dns.ddns.net). This gives you ad-blocking everywhere, even on cellular data! iOS: You can use a profile to configure DoH. A simple way is to use a site like AdGuard‚Äôs DNS profile generator, but enter your own server‚Äôs DoH address (https://my-dns.ddns.net/dns-query). ## Chapter 10: The Ultimate Safety Net (Creating a Snapshot) üì∏ Finally, let‚Äôs back up our perfect setup.\nIn the EC2 Console, go to your instance details. Click the ‚ÄúStorage‚Äù tab and click the ‚ÄúVolume ID‚Äù. Click ‚ÄúActions‚Äù -\u003e ‚ÄúCreate snapshot‚Äù. Give it a description, like AdGuard-Working-Setup-Backup. If you ever mess something up, you can use this snapshot to restore your server to this exact working state in minutes.\n## Bonus Chapter: Common Troubleshooting Tips If things aren‚Äôt working, here are a few common pitfalls to check:\nBrowser Overrides Everything: If one device isn‚Äôt blocking ads, check its browser settings! Modern browsers like Chrome have a ‚ÄúSecure DNS‚Äù feature that can bypass your custom setup. You may need to turn this off. Check Your Laptop‚Äôs DNS: Make sure your computer‚Äôs network settings are set to ‚ÄúObtain DNS automatically‚Äù so it listens to the router. A manually set DNS on your PC will ignore the router‚Äôs settings. Beware of IPv6: If you run into trouble on one device, try disabling IPv6 in that device‚Äôs Wi-Fi adapter properties to force it to use your working IPv4 setup. ## It‚Äôs a Wrap! And there you have it! You‚Äôve successfully built a personal, secure, ad-blocking DNS server in the cloud. You‚Äôve learned about cloud computing, firewalls, DNS, SSL, and automation. Go enjoy a faster, cleaner, and more private internet experience.\n",
  "wordCount" : "1935",
  "inLanguage": "en",
  "image":"http://localhost:1313/projects/adguard-linode/adguard_aws.webp","datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/projects/adguard-updated/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Prajwol Bikram Adhikari",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header sticky-header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Prajwol Bikram Adhikari (Alt + H)">Prajwol Bikram Adhikari</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li></li>
                </ul>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/projects" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/blog" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/experience" title="Experience">
                    <span>Experience</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;¬ª&nbsp;<a href="http://localhost:1313/projects/">Projects</a></div>
    <h1 class="post-title">
      How I Built My Own Ad-Blocking DNS Server in the Cloud (2025 Updated Edition!)
    </h1>
    <div class="post-meta">


Aug 2025

</div>
  </header> 
<figure class="entry-cover"><img loading="lazy" src="http://localhost:1313/projects/adguard-linode/adguard_aws.webp" alt="">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">‚Äé Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#your-personal-internet-guardian-how-to-build-a-free-ad-blocker-in-the-cloud-" aria-label="Your Personal Internet Guardian: How to Build a FREE Ad-Blocker in the Cloud! üöÄ">Your Personal Internet Guardian: How to Build a FREE Ad-Blocker in the Cloud! üöÄ</a><ul>
                        <ul>
                        
                <li>
                    <a href="#-chapter-1-building-our-home-in-the-aws-cloud-" aria-label="## Chapter 1: Building Our Home in the AWS Cloud ‚òÅÔ∏è">## Chapter 1: Building Our Home in the AWS Cloud ‚òÅÔ∏è</a></li>
                <li>
                    <a href="#-chapter-2-opening-the-doors-configuring-the-firewall-" aria-label="## Chapter 2: Opening the Doors (Configuring the Firewall) üö™">## Chapter 2: Opening the Doors (Configuring the Firewall) üö™</a></li>
                <li>
                    <a href="#-chapter-3-installing-adguard-home-" aria-label="## Chapter 3: Installing AdGuard Home üõ°Ô∏è">## Chapter 3: Installing AdGuard Home üõ°Ô∏è</a></li>
                <li>
                    <a href="#-chapter-4-teaching-your-guardian-who-to-trust-and-what-to-block" aria-label="## Chapter 4: Teaching Your Guardian Who to Trust and What to Block">## Chapter 4: Teaching Your Guardian Who to Trust and What to Block</a><ul>
                        
                <li>
                    <a href="#1-setting-up-upstream-dns-servers" aria-label="1. Setting Up Upstream DNS Servers"><strong>1. Setting Up Upstream DNS Servers</strong></a></li>
                <li>
                    <a href="#2-optimizing-dns-performance" aria-label="2. Optimizing DNS Performance"><strong>2. Optimizing DNS Performance</strong></a></li>
                <li>
                    <a href="#3-enabling-dnssec" aria-label="3. Enabling DNSSEC"><strong>3. Enabling DNSSEC</strong></a></li>
                <li>
                    <a href="#4-choosing-your-blocklists" aria-label="4. Choosing Your Blocklists"><strong>4. Choosing Your Blocklists</strong></a></li></ul>
                </li>
                <li>
                    <a href="#-chapter-5-giving-your-server-a-name-free-domain-with-no-ip-" aria-label="## Chapter 5: Giving Your Server a Name (Free Domain with No-IP) üìõ">## Chapter 5: Giving Your Server a Name (Free Domain with No-IP) üìõ</a></li>
                <li>
                    <a href="#-chapter-6-making-it-secure-with-ssltls-" aria-label="## Chapter 6: Making It Secure with SSL/TLS üîê">## Chapter 6: Making It Secure with SSL/TLS üîê</a></li>
                <li>
                    <a href="#-chapter-7-automating-ssl-renewal-cron-job-magic-" aria-label="## Chapter 7: Automating SSL Renewal (Cron Job Magic) ‚ú®">## Chapter 7: Automating SSL Renewal (Cron Job Magic) ‚ú®</a></li>
                <li>
                    <a href="#-chapter-8-testing-your-new-superpowers-doh--dot-" aria-label="## Chapter 8: Testing Your New Superpowers (DoH &amp; DoT) üß™">## Chapter 8: Testing Your New Superpowers (DoH &amp; DoT) üß™</a></li>
                <li>
                    <a href="#-chapter-9-protecting-your-kingdom-router--phone-setup-" aria-label="## Chapter 9: Protecting Your Kingdom (Router &amp; Phone Setup) üè∞">## Chapter 9: Protecting Your Kingdom (Router &amp; Phone Setup) üè∞</a></li>
                <li>
                    <a href="#-chapter-10-the-ultimate-safety-net-creating-a-snapshot-" aria-label="## Chapter 10: The Ultimate Safety Net (Creating a Snapshot) üì∏">## Chapter 10: The Ultimate Safety Net (Creating a Snapshot) üì∏</a></li>
                <li>
                    <a href="#-bonus-chapter-common-troubleshooting-tips" aria-label="## Bonus Chapter: Common Troubleshooting Tips">## Bonus Chapter: Common Troubleshooting Tips</a></li>
                <li>
                    <a href="#-its-a-wrap" aria-label="## It‚Äôs a Wrap!">## It‚Äôs a Wrap!</a>
                </li>
            </ul>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="your-personal-internet-guardian-how-to-build-a-free-ad-blocker-in-the-cloud-">Your Personal Internet Guardian: How to Build a FREE Ad-Blocker in the Cloud! üöÄ<a hidden class="anchor" aria-hidden="true" href="#your-personal-internet-guardian-how-to-build-a-free-ad-blocker-in-the-cloud-">#</a></h1>
<p>Hey everyone! A while back, I wrote a guide on setting up AdGuard Home on Linode. The world of tech moves fast, and it&rsquo;s time for an upgrade! Today, we&rsquo;re going to build our own powerful, network-wide ad-blocker using <strong>Amazon Web Services (AWS)</strong>, and we&rsquo;ll make it secure with our own domain and SSL certificate.</p>
<p>Think of this as building a digital gatekeeper for your internet. Before any ads, trackers, or malicious sites can reach your devices, our AdGuard Home server will slam the door shut. The best part? This works on your phone, laptop, smart TV‚Äîanything on your network‚Äîwithout installing a single app on them.</p>
<p>This guide is for everyone, from seasoned tech wizards to curious beginners. We&rsquo;ll break down every step in simple terms, so grab a coffee, and let&rsquo;s build something awesome!</p>
<hr>
<h3 id="-chapter-1-building-our-home-in-the-aws-cloud-">## Chapter 1: Building Our Home in the AWS Cloud ‚òÅÔ∏è<a hidden class="anchor" aria-hidden="true" href="#-chapter-1-building-our-home-in-the-aws-cloud-">#</a></h3>
<p>First, we need a server. We&rsquo;ll use an <strong>Amazon EC2 instance</strong>, which is just a fancy name for a virtual computer that you rent.</p>
<ol>
<li>
<p><strong>Sign Up for AWS:</strong> If you don&rsquo;t have an account, head to the <a href="https://aws.amazon.com/">AWS website</a> and sign up. You&rsquo;ll need a credit card for verification, but for this guide, we can often stay within the Free Tier.</p>
</li>
<li>
<p><strong>Launch Your EC2 Instance:</strong></p>
<ul>
<li>Log in to your AWS Console and search for <strong>EC2</strong>.</li>
<li>Click <strong>&ldquo;Launch instance&rdquo;</strong>.</li>
<li><strong>Name:</strong> Give your server a cool name, like <code>AdGuard-Server</code>.</li>
<li><strong>Application and OS Images:</strong> In the search bar, type <code>Debian</code> and select the latest version (e.g., Debian 12). Make sure it&rsquo;s marked &ldquo;Free tier eligible&rdquo;.</li>
<li><strong>Instance Type:</strong> Choose <strong><code>t2.micro</code></strong>. This is your free, trusty little server.</li>
<li><strong>Key Pair (for login):</strong> This is your digital key to the server&rsquo;s front door. Click <strong>&ldquo;Create a new key pair&rdquo;</strong>, name it something like <code>my-adguard-key</code>, and <strong>download the <code>.pem</code> file</strong>. Keep this file secret and safe!</li>
<li><strong>Network settings (The Firewall):</strong> This is crucial. We need to tell our server which doors to open. Click <strong>&ldquo;Edit&rdquo;</strong>.
<ul>
<li>Check the box for <strong>&ldquo;Allow SSH traffic from&rdquo;</strong> and select <strong><code>My IP</code></strong>. This lets you securely log in.</li>
<li>Check <strong>&ldquo;Allow HTTPS traffic from the internet&rdquo;</strong> and <strong>&ldquo;Allow HTTP traffic from the internet&rdquo;</strong>. We&rsquo;ll need these for our secure dashboard later.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Launch It!</strong> Hit the &ldquo;Launch instance&rdquo; button and watch as your new cloud server comes to life.</p>
</li>
<li>
<p><strong>Give Your Server a Permanent Address (Elastic IP):</strong></p>
<ul>
<li>By default, your server&rsquo;s public IP address will change every time it reboots. Let&rsquo;s make it permanent!</li>
<li>In the EC2 menu on the left, go to <strong>&ldquo;Elastic IPs&rdquo;</strong>.</li>
<li>Click <strong>&ldquo;Allocate Elastic IP address&rdquo;</strong> and then <strong>&ldquo;Allocate&rdquo;</strong>.</li>
<li>Select the new IP address from the list, click <strong>&ldquo;Actions&rdquo;</strong>, and then <strong>&ldquo;Associate Elastic IP address&rdquo;</strong>.</li>
<li>Choose your <code>AdGuard-Server</code> instance from the list and click <strong>&ldquo;Associate&rdquo;</strong>.</li>
<li>Your server now has a static IP address that will never change! Make a note of this new IP.</li>
</ul>
</li>
</ol>
<hr>
<h3 id="-chapter-2-opening-the-doors-configuring-the-firewall-">## Chapter 2: Opening the Doors (Configuring the Firewall) üö™<a hidden class="anchor" aria-hidden="true" href="#-chapter-2-opening-the-doors-configuring-the-firewall-">#</a></h3>
<p>Our server is running, but we need to open a few more specific doors for AdGuard Home to work.</p>
<ol>
<li>Go to your EC2 Instance details, click the <strong>&ldquo;Security&rdquo;</strong> tab, and click on the <strong>Security Group name</strong>.</li>
<li>Click <strong>&ldquo;Edit inbound rules&rdquo;</strong> and <strong>&ldquo;Add rule&rdquo;</strong> for each of the following:
<ul>
<li><strong>Port <code>3000</code>:</strong> <code>Custom TCP</code>, Port <code>3000</code>, Source <code>My IP</code>. (For the initial setup).</li>
<li><strong>Port <code>53</code> (TCP):</strong> <code>Custom TCP</code>, Port <code>53</code>, Source <code>Anywhere-IPv4</code>. (For DNS).</li>
<li><strong>Port <code>53</code> (UDP):</strong> <code>Custom UDP</code>, Port <code>53</code>, Source <code>Anywhere-IPv4</code>. (Also for DNS).</li>
<li><strong>Port <code>853</code>:</strong> <code>Custom TCP</code>, Port <code>853</code>, Source <code>Anywhere-IPv4</code>. (For DNS-over-TLS).</li>
</ul>
</li>
<li>Click <strong>&ldquo;Save rules&rdquo;</strong>. Your firewall is now ready!</li>
</ol>
<hr>
<h3 id="-chapter-3-installing-adguard-home-">## Chapter 3: Installing AdGuard Home üõ°Ô∏è<a hidden class="anchor" aria-hidden="true" href="#-chapter-3-installing-adguard-home-">#</a></h3>
<p>Now, let&rsquo;s connect to our server and install the magic software.</p>
<ol>
<li><strong>Connect via SSH:</strong> Open a terminal (PowerShell on Windows, Terminal on Mac/Linux) and use the key you downloaded to connect. <strong>Use your new Elastic IP address!</strong>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Replace the path and Elastic IP with your own</span>
</span></span><span style="display:flex;"><span>ssh -i <span style="color:#e6db74">&#34;path/to/my-adguard-key.pem&#34;</span> admin@YOUR_ELASTIC_IP
</span></span></code></pre></div></li>
<li><strong>Install AdGuard Home:</strong> Run this one simple command. It downloads and installs everything for you.
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -s -S -L <span style="color:#f92672">[</span>https://raw.githubusercontent.com/AdguardTeam/AdGuardHome/master/scripts/install.sh<span style="color:#f92672">](</span>https://raw.githubusercontent.com/AdguardTeam/AdGuardHome/master/scripts/install.sh<span style="color:#f92672">)</span> | sh -s -- -v
</span></span></code></pre></div></li>
<li><strong>Run the Setup Wizard:</strong> The script will give you a link, like <code>http://YOUR_ELASTIC_IP:3000</code>. Open this in your browser. Follow the on-screen steps to create your admin username and password.</li>
</ol>
<hr>
<h3 id="-chapter-4-teaching-your-guardian-who-to-trust-and-what-to-block">## Chapter 4: Teaching Your Guardian Who to Trust and What to Block<a hidden class="anchor" aria-hidden="true" href="#-chapter-4-teaching-your-guardian-who-to-trust-and-what-to-block">#</a></h3>
<p>With AdGuard Home installed, the next step is to configure its core brain: the DNS servers it gets its answers from and the blocklists it uses to protect your network.</p>
<h4 id="1-setting-up-upstream-dns-servers"><strong>1. Setting Up Upstream DNS Servers</strong><a hidden class="anchor" aria-hidden="true" href="#1-setting-up-upstream-dns-servers">#</a></h4>
<p>Think of &ldquo;Upstream DNS Servers&rdquo; as the giant, public phonebooks of the internet. When your AdGuard server doesn&rsquo;t know an address (and it&rsquo;s not on a blocklist), it asks one of these upstreams. It&rsquo;s recommended to use a mix of the best encrypted DNS providers for security, privacy, and speed.</p>
<p>In the AdGuard dashboard, go to <strong>Settings -&gt; DNS settings</strong>. In the <strong>&ldquo;Upstream DNS servers&rdquo;</strong> box, enter the following, one per line:</p>
<ul>
<li><a href="https://dns.quad9.net/dns-query">https://dns.quad9.net/dns-query</a></li>
<li><a href="https://dns.google/dns-query">https://dns.google/dns-query</a></li>
<li><a href="https://dns.cloudflare.com/dns-query">https://dns.cloudflare.com/dns-query</a></li>
</ul>
<ul>
<li><strong>Quad9:</strong> Focuses heavily on security, blocking malicious domains.</li>
<li><strong>Google:</strong> Known for being very fast.</li>
<li><strong>Cloudflare:</strong> A great all-around choice with a strong focus on privacy.</li>
</ul>
<h4 id="2-optimizing-dns-performance"><strong>2. Optimizing DNS Performance</strong><a hidden class="anchor" aria-hidden="true" href="#2-optimizing-dns-performance">#</a></h4>
<p>Still in the <strong>DNS settings</strong> page, scroll down to optimize how your server queries the upstreams.</p>
<ul>
<li>
<p><strong>Parallel requests:</strong> Select this option. This is the fastest and most resilient mode. It sends your DNS query to all three of your upstream servers at the same time and uses the answer from the very first one that responds. This ensures you always get the quickest possible result.</p>
</li>
<li>
<p><strong>Enable EDNS client subnet (ECS):</strong> Check this box. This is very important for services like Netflix, YouTube, and other content delivery networks (CDNs). It helps them give you content from a server that is geographically closest to you, resulting in faster speeds and a better experience.</p>
</li>
</ul>
<h4 id="3-enabling-dnssec"><strong>3. Enabling DNSSEC</strong><a hidden class="anchor" aria-hidden="true" href="#3-enabling-dnssec">#</a></h4>
<p>Right below the upstream servers, there&rsquo;s a checkbox for <strong>&ldquo;Enable DNSSEC&rdquo;</strong>. You should check this box. DNSSEC is like a digital wax seal on a letter; it verifies that the DNS answers you&rsquo;re getting are authentic and haven&rsquo;t been tampered with. It&rsquo;s a simple, one-click security boost.</p>
<h4 id="4-choosing-your-blocklists"><strong>4. Choosing Your Blocklists</strong><a hidden class="anchor" aria-hidden="true" href="#4-choosing-your-blocklists">#</a></h4>
<p>This is the fun part‚Äîthe actual ad-blocking! Go to <strong>Filters -&gt; DNS blocklists</strong>. For a &ldquo;Balanced &amp; Powerful&rdquo; setup that blocks aggressively without a high risk of breaking websites, enable the following lists:</p>
<ul>
<li><strong>AdGuard DNS filter:</strong> A great, well-maintained baseline.</li>
<li><strong>OISD Blocklist Big:</strong> Widely considered one of the best all-in-one lists for blocking ads, trackers, and malware.</li>
<li><strong>HaGeZi&rsquo;s Pro Blocklist:</strong> A fantastic list that adds another layer of aggressive blocking for privacy.</li>
<li><strong>HaGeZi&rsquo;s Threat Intelligence Feed:</strong> A crucial security-only list that focuses on protecting against active threats like phishing and malware.</li>
</ul>
<p>This combination will give you robust protection against both annoyances and real dangers.</p>
<hr>
<h3 id="-chapter-5-giving-your-server-a-name-free-domain-with-no-ip-">## Chapter 5: Giving Your Server a Name (Free Domain with No-IP) üìõ<a hidden class="anchor" aria-hidden="true" href="#-chapter-5-giving-your-server-a-name-free-domain-with-no-ip-">#</a></h3>
<p>An IP address is hard to remember. Let&rsquo;s get a free, memorable name for our server.</p>
<ol>
<li><strong>Sign Up at No-IP:</strong> Go to <a href="https://www.noip.com/">No-IP.com</a>, create a free account, and create a <strong>hostname</strong> (e.g., <code>my-dns.ddns.net</code>).</li>
<li><strong>Point it to Your Server:</strong> When creating the hostname, enter your server&rsquo;s permanent <strong>Elastic IP address</strong>. Confirm your account via email.</li>
</ol>
<hr>
<h3 id="-chapter-6-making-it-secure-with-ssltls-">## Chapter 6: Making It Secure with SSL/TLS üîê<a hidden class="anchor" aria-hidden="true" href="#-chapter-6-making-it-secure-with-ssltls-">#</a></h3>
<p>We&rsquo;ll use <strong>Let&rsquo;s Encrypt</strong> and <strong>Certbot</strong> to get a free SSL certificate, which lets us use secure <code>https://</code> and encrypted DNS.</p>
<ol>
<li>
<p><strong>Install Certbot:</strong> In your SSH session, run these commands:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt update
</span></span><span style="display:flex;"><span>sudo apt install certbot -y
</span></span></code></pre></div></li>
<li>
<p><strong>Get the Certificate:</strong> Run this command, replacing the email and domain with your own.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># This command will temporarily stop any service on port 80, get the certificate, and then finish.</span>
</span></span><span style="display:flex;"><span>sudo certbot certonly --standalone --agree-tos --email YOUR_EMAIL@example.com -d your-no-ip-hostname.ddns.net
</span></span></code></pre></div><p>If it&rsquo;s successful, it will tell you where your certificate files are saved (usually in <code>/etc/letsencrypt/live/your-no-ip-hostname.ddns.net/</code>).</p>
</li>
<li>
<p><strong>Configure AdGuard Home Encryption:</strong></p>
<ul>
<li>Go to your AdGuard Home dashboard (<strong>Settings -&gt; Encryption settings</strong>).</li>
<li>Check <strong>&ldquo;Enable encryption&rdquo;</strong>.</li>
<li>In the <strong>&ldquo;Server name&rdquo;</strong> field, enter your No-IP hostname.</li>
<li>Under <strong>&ldquo;Certificates&rdquo;</strong>, choose <strong>&ldquo;Set a certificates file path&rdquo;</strong>.
<ul>
<li><strong>Certificate path:</strong> <code>/etc/letsencrypt/live/your-no-ip-hostname.ddns.net/fullchain.pem</code></li>
<li><strong>Private key path:</strong> <code>/etc/letsencrypt/live/your-no-ip-hostname.ddns.net/privkey.pem</code></li>
</ul>
</li>
<li>Click <strong>&ldquo;Save configuration&rdquo;</strong>. The page will reload on a secure <code>https://</code> connection!</li>
</ul>
</li>
</ol>
<hr>
<h3 id="-chapter-7-automating-ssl-renewal-cron-job-magic-">## Chapter 7: Automating SSL Renewal (Cron Job Magic) ‚ú®<a hidden class="anchor" aria-hidden="true" href="#-chapter-7-automating-ssl-renewal-cron-job-magic-">#</a></h3>
<p>Let&rsquo;s Encrypt certificates last for 90 days. We can tell our server to automatically renew them.</p>
<ol>
<li><strong>Open the Cron Editor:</strong> In SSH, run <code>sudo crontab -e</code> and choose <code>nano</code> as your editor.</li>
<li><strong>Add the Renewal Job:</strong> Add this line to the bottom of the file. It tells the server to try renewing the certificate every day at 2:30 AM.
<pre tabindex="0"><code>30 2 * * * systemctl stop AdGuardHome.service &amp;&amp; certbot renew --quiet &amp;&amp; systemctl start AdGuardHome.service
</code></pre></li>
<li>Save and exit (<code>Ctrl+X</code>, then <code>Y</code>, then <code>Enter</code>). Your server will now keep its certificate fresh forever!</li>
</ol>
<hr>
<h3 id="-chapter-8-testing-your-new-superpowers-doh--dot-">## Chapter 8: Testing Your New Superpowers (DoH &amp; DoT) üß™<a hidden class="anchor" aria-hidden="true" href="#-chapter-8-testing-your-new-superpowers-doh--dot-">#</a></h3>
<p>For a direct confirmation, I used these commands on my computer:</p>
<ul>
<li>
<p><strong>DNS-over-HTTPS (DoH) Test:</strong> This test checks if the secure web endpoint for DNS is alive.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -v <span style="color:#f92672">[</span>https://your-no-ip-hostname.ddns.net/dns-query<span style="color:#f92672">](</span>https://your-no-ip-hostname.ddns.net/dns-query<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>I got a &ldquo;405 Method Not Allowed&rdquo; error, which sounds bad but is actually <strong>great news</strong>. It means I successfully connected to the server, which correctly told me I didn&rsquo;t send a real query. The connection works!</p>
</li>
<li>
<p><strong>DNS-over-TLS (DoT) Test:</strong> This checks the dedicated secure port for DNS. I used a tool called <code>kdig</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># I had to install it first with: sudo apt install knot-dnsutils</span>
</span></span><span style="display:flex;"><span>kdig @your-no-ip-hostname.ddns.net +tls-ca +tls-host<span style="color:#f92672">=</span>your-no-ip-hostname.ddns.net example.com
</span></span></code></pre></div><p>The command returned a perfect DNS answer for <code>example.com</code>, confirming the secure tunnel was working.</p>
</li>
</ul>
<hr>
<h3 id="-chapter-9-protecting-your-kingdom-router--phone-setup-">## Chapter 9: Protecting Your Kingdom (Router &amp; Phone Setup) üè∞<a hidden class="anchor" aria-hidden="true" href="#-chapter-9-protecting-your-kingdom-router--phone-setup-">#</a></h3>
<p>Now, let&rsquo;s point your devices to their new guardian.</p>
<ul>
<li><strong>On Your Home Router:</strong> Log in to your router&rsquo;s admin page, find the DNS settings, and enter your server&rsquo;s <strong>Elastic IP</strong> as the primary DNS server. Leave the secondary field blank! This forces all devices on your Wi-Fi to be protected. Then, restart your router.</li>
<li><strong>On Your Mobile Phone:</strong>
<ul>
<li><strong>Android:</strong> Go to <strong>Settings -&gt; Network -&gt; Private DNS</strong>. Choose &ldquo;Private DNS provider hostname&rdquo; and enter your No-IP hostname (<code>my-dns.ddns.net</code>). This gives you ad-blocking everywhere, even on cellular data!</li>
<li><strong>iOS:</strong> You can use a profile to configure DoH. A simple way is to use a site like <a href="https://adguard-dns.io/en/public-dns.html">AdGuard&rsquo;s DNS profile generator</a>, but enter your own server&rsquo;s DoH address (<code>https://my-dns.ddns.net/dns-query</code>).</li>
</ul>
</li>
</ul>
<hr>
<h3 id="-chapter-10-the-ultimate-safety-net-creating-a-snapshot-">## Chapter 10: The Ultimate Safety Net (Creating a Snapshot) üì∏<a hidden class="anchor" aria-hidden="true" href="#-chapter-10-the-ultimate-safety-net-creating-a-snapshot-">#</a></h3>
<p>Finally, let&rsquo;s back up our perfect setup.</p>
<ol>
<li>In the EC2 Console, go to your instance details.</li>
<li>Click the <strong>&ldquo;Storage&rdquo;</strong> tab and click the <strong>&ldquo;Volume ID&rdquo;</strong>.</li>
<li>Click <strong>&ldquo;Actions&rdquo; -&gt; &ldquo;Create snapshot&rdquo;</strong>.</li>
<li>Give it a description, like <code>AdGuard-Working-Setup-Backup</code>.</li>
</ol>
<p>If you ever mess something up, you can use this snapshot to restore your server to this exact working state in minutes.</p>
<h3 id="-bonus-chapter-common-troubleshooting-tips">## Bonus Chapter: Common Troubleshooting Tips<a hidden class="anchor" aria-hidden="true" href="#-bonus-chapter-common-troubleshooting-tips">#</a></h3>
<p>If things aren&rsquo;t working, here are a few common pitfalls to check:</p>
<ul>
<li><strong>Browser Overrides Everything:</strong> If one device isn&rsquo;t blocking ads, check its browser settings! Modern browsers like Chrome have a &ldquo;Secure DNS&rdquo; feature that can bypass your custom setup. You may need to turn this off.</li>
<li><strong>Check Your Laptop&rsquo;s DNS:</strong> Make sure your computer&rsquo;s network settings are set to &ldquo;Obtain DNS automatically&rdquo; so it listens to the router. A manually set DNS on your PC will ignore the router&rsquo;s settings.</li>
<li><strong>Beware of IPv6:</strong> If you run into trouble on one device, try disabling IPv6 in that device&rsquo;s Wi-Fi adapter properties to force it to use your working IPv4 setup.</li>
</ul>
<h3 id="-its-a-wrap">## It‚Äôs a Wrap!<a hidden class="anchor" aria-hidden="true" href="#-its-a-wrap">#</a></h3>
<p>And there you have it! You&rsquo;ve successfully built a personal, secure, ad-blocking DNS server in the cloud. You&rsquo;ve learned about cloud computing, firewalls, DNS, SSL, and automation. Go enjoy a faster, cleaner, and more private internet experience.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/adguard/">AdGuard</a></li>
      <li><a href="http://localhost:1313/tags/cloudcomputing/">CloudComputing</a></li>
      <li><a href="http://localhost:1313/tags/aws/">AWS</a></li>
      <li><a href="http://localhost:1313/tags/ec2/">EC2</a></li>
      <li><a href="http://localhost:1313/tags/firewall/">Firewall</a></li>
      <li><a href="http://localhost:1313/tags/elastic-ip/">Elastic IP</a></li>
      <li><a href="http://localhost:1313/tags/letsencrypt/">LetsEncrypt</a></li>
      <li><a href="http://localhost:1313/tags/certbot/">Certbot</a></li>
      <li><a href="http://localhost:1313/tags/debian/">Debian</a></li>
      <li><a href="http://localhost:1313/tags/no-ip/">No-IP</a></li>
      <li><a href="http://localhost:1313/tags/ssl/">SSL</a></li>
      <li><a href="http://localhost:1313/tags/tls/">TLS</a></li>
      <li><a href="http://localhost:1313/tags/cron/">Cron</a></li>
      <li><a href="http://localhost:1313/tags/dns/">DNS</a></li>
      <li><a href="http://localhost:1313/tags/doh/">DoH</a></li>
      <li><a href="http://localhost:1313/tags/dot/">DoT</a></li>
      <li><a href="http://localhost:1313/tags/dnssec/">DNSSEC</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="http://localhost:1313/">Prajwol Bikram Adhikari</a> ¬∑ <a href="/privacy-policy/">Privacy Policy</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>

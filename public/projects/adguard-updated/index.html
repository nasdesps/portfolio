<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>How I Built My Own Ad-Blocking DNS Server in the Cloud (Updated AWS Edition!) | Prajwol Bikram Adhikari</title>
<script>(function(){const t=document.documentElement,n=localStorage.getItem("pref-theme");let e;n?e=n:e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",e==="dark"?t.classList.add("dark"):t.classList.remove("dark")})(),window.addEventListener("DOMContentLoaded",e=>{const s=document.getElementById("theme-toggle"),t=document.getElementById("sun"),n=document.getElementById("moon");function o(){document.documentElement.classList.contains("dark")?(t.style.setProperty("display","inline-block","important"),n.style.setProperty("display","none","important")):(t.style.setProperty("display","none","important"),n.style.setProperty("display","inline-block","important"))}s&&t&&n&&(o(),s.addEventListener("click",function(){const e=document.documentElement.classList.toggle("dark");localStorage.setItem("pref-theme",e?"dark":"light"),o()}))})</script><meta name=keywords content="AdGuard Home,Self-Hosting,Homelab,CloudComputing,Cloud,Linux,AWS,EC2,Firewall,Elastic IP,LetsEncrypt,Certbot,Debian,No-IP,SSL,TLS,Cron,DNS,DoH,DoT,DNSSEC,Opensource,DoH,DoT"><meta name=description content="Enjoy a faster, ad-free internet everywhere. This 2025 guide details how to build a free, private DNS server with AdGuard Home on an AWS EC2 instance, complete with SSL encryption and automated renewal."><meta name=author content><link rel=canonical href=http://localhost:1313/projects/adguard-updated/><link crossorigin=anonymous href=/assets/css/stylesheet.min.4569f4b9415f55738c1dddaa494928abed4eb6975730b533cc293029543f6e38.css integrity="sha256-RWn0uUFfVXOMHd2qSUkoq+1OtpdXMLUzzCkwKVQ/bjg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.2eadbb982468c11a433a3e291f01326f2ba43f065e256bf792dbd79640a92316.js integrity="sha256-Lq27mCRowRpDOj4pHwEybyukPwZeJWv3ktvXlkCpIxY=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/projects/adguard-updated/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><meta property="og:title" content="How I Built My Own Ad-Blocking DNS Server in the Cloud (Updated AWS Edition!)"><meta property="og:description" content="Enjoy a faster, ad-free internet everywhere. This 2025 guide details how to build a free, private DNS server with AdGuard Home on an AWS EC2 instance, complete with SSL encryption and automated renewal."><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/projects/adguard-updated/"><meta property="og:image" content="http://localhost:1313/projects/adguard-aws/adguardaws_hu_45967047f0617baa.jpg"><meta property="article:section" content="projects"><meta property="article:published_time" content="2025-08-25T00:00:00+00:00"><meta property="article:modified_time" content="2025-08-25T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/projects/adguard-aws/adguardaws.png"><meta name=twitter:title content="How I Built My Own Ad-Blocking DNS Server in the Cloud (Updated AWS Edition!)"><meta name=twitter:description content="Enjoy a faster, ad-free internet everywhere. This 2025 guide details how to build a free, private DNS server with AdGuard Home on an AWS EC2 instance, complete with SSL encryption and automated renewal."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Projects","item":"http://localhost:1313/projects/"},{"@type":"ListItem","position":2,"name":"How I Built My Own Ad-Blocking DNS Server in the Cloud (Updated AWS Edition!)","item":"http://localhost:1313/projects/adguard-updated/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"How I Built My Own Ad-Blocking DNS Server in the Cloud (Updated AWS Edition!)","name":"How I Built My Own Ad-Blocking DNS Server in the Cloud (Updated AWS Edition!)","description":"Enjoy a faster, ad-free internet everywhere. This 2025 guide details how to build a free, private DNS server with AdGuard Home on an AWS EC2 instance, complete with SSL encryption and automated renewal.","keywords":["AdGuard Home","Self-Hosting","Homelab","CloudComputing","Cloud","Linux","AWS","EC2","Firewall","Elastic IP","LetsEncrypt","Certbot","Debian","No-IP","SSL","TLS","Cron","DNS","DoH","DoT","DNSSEC","Opensource","DoH","DoT"],"articleBody":"Your Personal Internet Guardian: How to Build a FREE Ad-Blocker in the Cloud! üöÄ Hey everyone! A while back, I wrote a guide on setting up AdGuard Home on Linode. The world of tech moves fast, and it‚Äôs time for an upgrade! Today, we‚Äôre going to build our own powerful, network-wide ad-blocker using Amazon Web Services (AWS), and we‚Äôll make it secure with our own domain and SSL certificate.\nThink of this as building a digital gatekeeper for your internet. Before any ads, trackers, or malicious sites can reach your devices, our AdGuard Home server will slam the door shut. The best part? This works on your phone, laptop, smart TV‚Äîanything on your network‚Äîwithout installing a single app on them.\nThis guide is for everyone, from seasoned tech wizards to curious beginners. We‚Äôll break down every step in simple terms, so grab a coffee, and let‚Äôs build something awesome!\n## Chapter 1: Building Our Home in the AWS Cloud ‚òÅÔ∏è First, we need a server. We‚Äôll use an Amazon EC2 instance, which is just a fancy name for a virtual computer that you rent.\nSign Up for AWS: If you don‚Äôt have an account, head to the AWS website and sign up. You‚Äôll need a credit card for verification, but for this guide, we can often stay within the Free Tier.\nLaunch Your EC2 Instance:\nLog in to your AWS Console and search for EC2. Click ‚ÄúLaunch instance‚Äù. Name: Give your server a cool name, like AdGuard-Server. Application and OS Images: In the search bar, type Debian and select the latest version (e.g., Debian 12). Make sure it‚Äôs marked ‚ÄúFree tier eligible‚Äù. Instance Type: Choose t2.micro. This is your free, trusty little server. Key Pair (for login): This is your digital key to the server‚Äôs front door. Click ‚ÄúCreate a new key pair‚Äù, name it something like my-adguard-key, and download the .pem file. Keep this file secret and safe! Network settings (The Firewall): This is crucial. We need to tell our server which doors to open. Click ‚ÄúEdit‚Äù. Check the box for ‚ÄúAllow SSH traffic from‚Äù and select My IP. This lets you securely log in. Check ‚ÄúAllow HTTPS traffic from the internet‚Äù and ‚ÄúAllow HTTP traffic from the internet‚Äù. We‚Äôll need these for our secure dashboard later. Launch It! Hit the ‚ÄúLaunch instance‚Äù button and watch as your new cloud server comes to life.\nGive Your Server a Permanent Address (Elastic IP):\nBy default, your server‚Äôs public IP address will change every time it reboots. Let‚Äôs make it permanent! In the EC2 menu on the left, go to ‚ÄúElastic IPs‚Äù. Click ‚ÄúAllocate Elastic IP address‚Äù and then ‚ÄúAllocate‚Äù. Select the new IP address from the list, click ‚ÄúActions‚Äù, and then ‚ÄúAssociate Elastic IP address‚Äù. Choose your AdGuard-Server instance from the list and click ‚ÄúAssociate‚Äù. Your server now has a static IP address that will never change! Make a note of this new IP. ## Chapter 2: Opening the Doors (Configuring the Firewall) üö™ Our server is running, but for maximum security, we want to ensure only you can access the administrative parts of it. We‚Äôll open the public DNS ports to everyone, but lock down the management ports to your home IP address.\nFind Your Public IP Address: Open a new browser tab and go to a site like WhatIsMyIP.com. It will display your home‚Äôs public IP address. Copy this IP address (it will look something like 203.0.113.55).\nEdit the Firewall Rules: Go to your EC2 Instance details, click the ‚ÄúSecurity‚Äù tab, and click on the Security Group name.\nClick ‚ÄúEdit inbound rules‚Äù and ‚ÄúAdd rule‚Äù for each of the following. This makes sure your DNS is publicly available but the setup panel is locked down to your IP only.\nRule for AdGuard Setup (Port 3000):\nType: Custom TCP Port range: 3000 Source: Paste your IP address here, and add /32 to the end (e.g., 203.0.113.55/32). The /32 tells AWS it‚Äôs a single, specific IP address. Rule for DNS (Port 53):\nType: Custom UDP and Custom TCP (you will add two separate rules for this port) Port range: 53 Source: Anywhere-IPv4 Rule for DNS-over-TLS (Port 853):\nType: Custom TCP Port range: 853 Source: Anywhere-IPv4 Click ‚ÄúSave rules‚Äù. Your firewall is now configured to allow public DNS requests while keeping your management panel secure.\n## Chapter 3: Installing AdGuard Home üõ°Ô∏è Now, let‚Äôs connect to our server and install the magic software.\nConnect via SSH: Open a terminal (PowerShell on Windows, Terminal on Mac/Linux) and use the key you downloaded to connect. Use your new Elastic IP address! # Replace the path and Elastic IP with your own ssh -i \"path/to/my-adguard-key.pem\" admin@YOUR_ELASTIC_IP Install AdGuard Home: Run this one simple command. It downloads and installs everything for you. curl -s -S -L https://raw.githubusercontent.com/AdguardTeam/AdGuardHome/master/scripts/install.sh | sh -s -- -v Run the Setup Wizard: The script will give you a link, like http://YOUR_ELASTIC_IP:3000. Open this in your browser. Follow the on-screen steps to create your admin username and password. ## Chapter 4: Teaching Your Guardian Who to Trust and What to Block With AdGuard Home installed, the next step is to configure its core brain: the DNS servers it gets its answers from and the blocklists it uses to protect your network.\n1. Setting Up Upstream DNS Servers Think of ‚ÄúUpstream DNS Servers‚Äù as the giant, public phonebooks of the internet. When your AdGuard server doesn‚Äôt know an address (and it‚Äôs not on a blocklist), it asks one of these upstreams. It‚Äôs recommended to use a mix of the best encrypted DNS providers for security, privacy, and speed.\nIn the AdGuard dashboard, go to Settings -\u003e DNS settings. In the ‚ÄúUpstream DNS servers‚Äù box, enter the following, one per line:\nhttps://dns.quad9.net/dns-query https://dns.google/dns-query https://dns.cloudflare.com/dns-query Quad9: Focuses heavily on security, blocking malicious domains. Google: Known for being very fast. Cloudflare: A great all-around choice with a strong focus on privacy. 2. Optimizing DNS Performance Still in the DNS settings page, scroll down to optimize how your server queries the upstreams.\nParallel requests: Select this option. This is the fastest and most resilient mode. It sends your DNS query to all three of your upstream servers at the same time and uses the answer from the very first one that responds. This ensures you always get the quickest possible result.\nEnable EDNS client subnet (ECS): Check this box. This is very important for services like Netflix, YouTube, and other content delivery networks (CDNs). It helps them give you content from a server that is geographically closest to you, resulting in faster speeds and a better experience.\n3. Enabling DNSSEC Right below the upstream servers, there‚Äôs a checkbox for ‚ÄúEnable DNSSEC‚Äù. You should check this box. DNSSEC is like a digital wax seal on a letter; it verifies that the DNS answers you‚Äôre getting are authentic and haven‚Äôt been tampered with. It‚Äôs a simple, one-click security boost.\n4. Choosing Your Blocklists This is the fun part‚Äîthe actual ad-blocking! Go to Filters -\u003e DNS blocklists. For a ‚ÄúBalanced \u0026 Powerful‚Äù setup that blocks aggressively without a high risk of breaking websites, enable the following lists:\nAdGuard DNS filter: A great, well-maintained baseline. OISD Blocklist Big: Widely considered one of the best all-in-one lists for blocking ads, trackers, and malware. HaGeZi‚Äôs Pro Blocklist: A fantastic list that adds another layer of aggressive blocking for privacy. HaGeZi‚Äôs Threat Intelligence Feed: A crucial security-only list that focuses on protecting against active threats like phishing and malware. This combination will give you robust protection against both annoyances and real dangers.\n## Chapter 5: Giving Your Server a Name (Free Domain with No-IP) üìõ An IP address is hard to remember. Let‚Äôs get a free, memorable name for our server.\nSign Up at No-IP: Go to No-IP.com, create a free account, and create a hostname (e.g., my-dns.ddns.net). Point it to Your Server: When creating the hostname, enter your server‚Äôs permanent Elastic IP address. Confirm your account via email. ## Chapter 6: Making It Secure with SSL/TLS üîê We‚Äôll use Let‚Äôs Encrypt and Certbot to get a free SSL certificate, which lets us use secure https:// and encrypted DNS.\nInstall Certbot: In your SSH session, run these commands:\nsudo apt update sudo apt install certbot -y Get the Certificate: Run this command, replacing the email and domain with your own.\n# This command will temporarily stop any service on port 80, get the certificate, and then finish. sudo certbot certonly --standalone --agree-tos --email YOUR_EMAIL@example.com -d your-no-ip-hostname.ddns.net If it‚Äôs successful, it will tell you where your certificate files are saved (usually in /etc/letsencrypt/live/your-no-ip-hostname.ddns.net/).\nConfigure AdGuard Home Encryption:\nGo to your AdGuard Home dashboard (Settings -\u003e Encryption settings). Check ‚ÄúEnable encryption‚Äù. In the ‚ÄúServer name‚Äù field, enter your No-IP hostname. Under ‚ÄúCertificates‚Äù, choose ‚ÄúSet a certificates file path‚Äù. Certificate path: /etc/letsencrypt/live/your-no-ip-hostname.ddns.net/fullchain.pem Private key path: /etc/letsencrypt/live/your-no-ip-hostname.ddns.net/privkey.pem Click ‚ÄúSave configuration‚Äù. The page will reload on a secure https:// connection! ## Chapter 7: Automating SSL Renewal (Cron Job Magic) ‚ú® Let‚Äôs Encrypt certificates last for 90 days. We can tell our server to automatically renew them.\nOpen Firewall (Port 80): Certbot requires port 80 for its renewal challenge. We must add this ufw rule on our server, or the renewal will fail.\nsudo ufw allow 80/tcp Open the Cron Editor: In SSH, run sudo crontab -e and choose nano as your editor.\nAdd the Renewal Job: Add this line to the bottom of the file. It tells the server to try renewing the certificate every day at 2:30 AM.\n30 2 * * * certbot renew --quiet --pre-hook \"systemctl stop AdGuardHome.service\" --post-hook \"systemctl start AdGuardHome.service\" Note: The --post-hook is critical. It guarantees AdGuard Home restarts even if the renewal fails, which prevents a service outage.\nSave and exit (Ctrl+X, then Y, then Enter). Your server will now keep its certificate fresh forever!\n## Chapter 8: Testing Your New Superpowers (DoH \u0026 DoT) üß™ For a direct confirmation, I used these commands on my computer:\nDNS-over-HTTPS (DoH) Test: This test checks if the secure web endpoint for DNS is alive.\ncurl -v [https://your-no-ip-hostname.ddns.net/dns-query](https://your-no-ip-hostname.ddns.net/dns-query) I got a ‚Äú405 Method Not Allowed‚Äù error, which sounds bad but is actually great news. It means I successfully connected to the server, which correctly told me I didn‚Äôt send a real query. The connection works!\nDNS-over-TLS (DoT) Test: This checks the dedicated secure port for DNS. I used a tool called kdig.\n# I had to install it first with: sudo apt install knot-dnsutils kdig @your-no-ip-hostname.ddns.net +tls-ca +tls-host=your-no-ip-hostname.ddns.net example.com The command returned a perfect DNS answer for example.com, confirming the secure tunnel was working.\n## Chapter 9: Protecting Your Kingdom (Router \u0026 Phone Setup) üè∞ Now, let‚Äôs point your devices to their new guardian.\nOn Your Home Router: Log in to your router‚Äôs admin page, find the DNS settings, and enter your server‚Äôs Elastic IP as the primary DNS server. Leave the secondary field blank! This forces all devices on your Wi-Fi to be protected. Then, restart your router. On Your Mobile Phone: Android: Go to Settings -\u003e Network -\u003e Private DNS. Choose ‚ÄúPrivate DNS provider hostname‚Äù and enter your No-IP hostname (my-dns.ddns.net). This gives you ad-blocking everywhere, even on cellular data! iOS: You can use a profile to configure DoH. A simple way is to use a site like AdGuard‚Äôs DNS profile generator, but enter your own server‚Äôs DoH address (https://my-dns.ddns.net/dns-query). ## Chapter 10: The Ultimate Safety Net (Creating a Snapshot) üì∏ Finally, let‚Äôs back up our perfect setup.\nIn the EC2 Console, go to your instance details. Click the ‚ÄúStorage‚Äù tab and click the ‚ÄúVolume ID‚Äù. Click ‚ÄúActions‚Äù -\u003e ‚ÄúCreate snapshot‚Äù. Give it a description, like AdGuard-Working-Setup-Backup. If you ever mess something up, you can use this snapshot to restore your server to this exact working state in minutes.\n## Bonus Chapter: Common Troubleshooting Tips If things aren‚Äôt working, here are a few common pitfalls to check:\nBrowser Overrides Everything: If one device isn‚Äôt blocking ads, check its browser settings! Modern browsers like Chrome have a ‚ÄúSecure DNS‚Äù feature that can bypass your custom setup. You may need to turn this off. Check Your Laptop‚Äôs DNS: Make sure your computer‚Äôs network settings are set to ‚ÄúObtain DNS automatically‚Äù so it listens to the router. A manually set DNS on your PC will ignore the router‚Äôs settings. Beware of IPv6: If you run into trouble on one device, try disabling IPv6 in that device‚Äôs Wi-Fi adapter properties to force it to use your working IPv4 setup. ## It‚Äôs a Wrap! And there you have it! You‚Äôve successfully built a personal, secure, ad-blocking DNS server in the cloud. You‚Äôve learned about cloud computing, firewalls, DNS, SSL, and automation. Go enjoy a faster, cleaner, and more private internet experience.\n","wordCount":"2103","inLanguage":"en","image":"http://localhost:1313/projects/adguard-aws/adguardaws.png","datePublished":"2025-08-25T00:00:00Z","dateModified":"2025-08-25T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/projects/adguard-updated/"},"publisher":{"@type":"Organization","name":"Prajwol Bikram Adhikari","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><header class="header sticky-header"><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Prajwol Bikram Adhikari (Alt + H)">Prajwol Bikram Adhikari</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li></li></ul></span></div><ul id=menu><li><a href=http://localhost:1313/ title=Home><span>Home</span></a></li><li><a href=http://localhost:1313/projects title=Projects><span>Projects</span></a></li><li><a href=http://localhost:1313/blog title=Blog><span>Blog</span></a></li><li><a href=http://localhost:1313/experience title=Experience><span>Experience</span></a></li><li><a href=http://localhost:1313/education title=Education><span>Education</span></a></li><li><a href=http://localhost:1313/search title="Search (Alt + /)" accesskey=/><span><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align:text-bottom"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg></span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;¬ª&nbsp;<a href=http://localhost:1313/projects/>Projects</a></div><h1 class=post-title>How I Built My Own Ad-Blocking DNS Server in the Cloud (Updated AWS Edition!)</h1><div class=post-description>Enjoy a faster, ad-free internet everywhere. This 2025 guide details how to build a free, private DNS server with AdGuard Home on an AWS EC2 instance, complete with SSL encryption and automated renewal.</div><div class=post-meta>Aug 2025</div></header><figure class=entry-cover><img loading=lazy src=http://localhost:1313/projects/adguard-aws/adguardaws_hu_1ed48f564d3f4198.webp alt="Cover image for How I Built My Own Ad-Blocking DNS Server in the Cloud (Updated AWS Edition!)" width=1040 height=567></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>‚Äé Table of Contents</span></summary><div class=inner><ul><li><a href=#your-personal-internet-guardian-how-to-build-a-free-ad-blocker-in-the-cloud- aria-label="Your Personal Internet Guardian: How to Build a FREE Ad-Blocker in the Cloud! üöÄ">Your Personal Internet Guardian: How to Build a FREE Ad-Blocker in the Cloud! üöÄ</a><ul><ul><li><a href=#-chapter-1-building-our-home-in-the-aws-cloud- aria-label="## Chapter 1: Building Our Home in the AWS Cloud ‚òÅÔ∏è">## Chapter 1: Building Our Home in the AWS Cloud ‚òÅÔ∏è</a></li><li><a href=#-chapter-2-opening-the-doors-configuring-the-firewall- aria-label="## Chapter 2: Opening the Doors (Configuring the Firewall) üö™">## Chapter 2: Opening the Doors (Configuring the Firewall) üö™</a></li><li><a href=#-chapter-3-installing-adguard-home- aria-label="## Chapter 3: Installing AdGuard Home üõ°Ô∏è">## Chapter 3: Installing AdGuard Home üõ°Ô∏è</a></li><li><a href=#-chapter-4-teaching-your-guardian-who-to-trust-and-what-to-block aria-label="## Chapter 4: Teaching Your Guardian Who to Trust and What to Block">## Chapter 4: Teaching Your Guardian Who to Trust and What to Block</a><ul><li><a href=#1-setting-up-upstream-dns-servers aria-label="1. Setting Up Upstream DNS Servers"><strong>1. Setting Up Upstream DNS Servers</strong></a></li><li><a href=#2-optimizing-dns-performance aria-label="2. Optimizing DNS Performance"><strong>2. Optimizing DNS Performance</strong></a></li><li><a href=#3-enabling-dnssec aria-label="3. Enabling DNSSEC"><strong>3. Enabling DNSSEC</strong></a></li><li><a href=#4-choosing-your-blocklists aria-label="4. Choosing Your Blocklists"><strong>4. Choosing Your Blocklists</strong></a></li></ul></li><li><a href=#-chapter-5-giving-your-server-a-name-free-domain-with-no-ip- aria-label="## Chapter 5: Giving Your Server a Name (Free Domain with No-IP) üìõ">## Chapter 5: Giving Your Server a Name (Free Domain with No-IP) üìõ</a></li><li><a href=#-chapter-6-making-it-secure-with-ssltls- aria-label="## Chapter 6: Making It Secure with SSL/TLS üîê">## Chapter 6: Making It Secure with SSL/TLS üîê</a></li><li><a href=#-chapter-7-automating-ssl-renewal-cron-job-magic- aria-label="## Chapter 7: Automating SSL Renewal (Cron Job Magic) ‚ú®">## Chapter 7: Automating SSL Renewal (Cron Job Magic) ‚ú®</a></li><li><a href=#-chapter-8-testing-your-new-superpowers-doh--dot- aria-label="## Chapter 8: Testing Your New Superpowers (DoH & DoT) üß™">## Chapter 8: Testing Your New Superpowers (DoH & DoT) üß™</a></li><li><a href=#-chapter-9-protecting-your-kingdom-router--phone-setup- aria-label="## Chapter 9: Protecting Your Kingdom (Router & Phone Setup) üè∞">## Chapter 9: Protecting Your Kingdom (Router & Phone Setup) üè∞</a></li><li><a href=#-chapter-10-the-ultimate-safety-net-creating-a-snapshot- aria-label="## Chapter 10: The Ultimate Safety Net (Creating a Snapshot) üì∏">## Chapter 10: The Ultimate Safety Net (Creating a Snapshot) üì∏</a></li><li><a href=#-bonus-chapter-common-troubleshooting-tips aria-label="## Bonus Chapter: Common Troubleshooting Tips">## Bonus Chapter: Common Troubleshooting Tips</a></li><li><a href=#-its-a-wrap aria-label="## It‚Äôs a Wrap!">## It‚Äôs a Wrap!</a></li></ul></ul></li></ul></div></details></div><div class=post-content><h1 id=your-personal-internet-guardian-how-to-build-a-free-ad-blocker-in-the-cloud->Your Personal Internet Guardian: How to Build a FREE Ad-Blocker in the Cloud! üöÄ<a hidden class=anchor aria-hidden=true href=#your-personal-internet-guardian-how-to-build-a-free-ad-blocker-in-the-cloud->#</a></h1><p>Hey everyone! A while back, I wrote a guide on setting up AdGuard Home on Linode. The world of tech moves fast, and it&rsquo;s time for an upgrade! Today, we&rsquo;re going to build our own powerful, network-wide ad-blocker using <strong>Amazon Web Services (AWS)</strong>, and we&rsquo;ll make it secure with our own domain and SSL certificate.</p><p>Think of this as building a digital gatekeeper for your internet. Before any ads, trackers, or malicious sites can reach your devices, our AdGuard Home server will slam the door shut. The best part? This works on your phone, laptop, smart TV‚Äîanything on your network‚Äîwithout installing a single app on them.</p><p>This guide is for everyone, from seasoned tech wizards to curious beginners. We&rsquo;ll break down every step in simple terms, so grab a coffee, and let&rsquo;s build something awesome!</p><hr><h3 id=-chapter-1-building-our-home-in-the-aws-cloud->## Chapter 1: Building Our Home in the AWS Cloud ‚òÅÔ∏è<a hidden class=anchor aria-hidden=true href=#-chapter-1-building-our-home-in-the-aws-cloud->#</a></h3><p>First, we need a server. We&rsquo;ll use an <strong>Amazon EC2 instance</strong>, which is just a fancy name for a virtual computer that you rent.</p><ol><li><p><strong>Sign Up for AWS:</strong> If you don&rsquo;t have an account, head to the <a href=https://aws.amazon.com/>AWS website</a> and sign up. You&rsquo;ll need a credit card for verification, but for this guide, we can often stay within the Free Tier.</p></li><li><p><strong>Launch Your EC2 Instance:</strong></p><ul><li>Log in to your AWS Console and search for <strong>EC2</strong>.</li><li>Click <strong>&ldquo;Launch instance&rdquo;</strong>.</li><li><strong>Name:</strong> Give your server a cool name, like <code>AdGuard-Server</code>.</li><li><strong>Application and OS Images:</strong> In the search bar, type <code>Debian</code> and select the latest version (e.g., Debian 12). Make sure it&rsquo;s marked &ldquo;Free tier eligible&rdquo;.</li><li><strong>Instance Type:</strong> Choose <strong><code>t2.micro</code></strong>. This is your free, trusty little server.</li><li><strong>Key Pair (for login):</strong> This is your digital key to the server&rsquo;s front door. Click <strong>&ldquo;Create a new key pair&rdquo;</strong>, name it something like <code>my-adguard-key</code>, and <strong>download the <code>.pem</code> file</strong>. Keep this file secret and safe!</li><li><strong>Network settings (The Firewall):</strong> This is crucial. We need to tell our server which doors to open. Click <strong>&ldquo;Edit&rdquo;</strong>.<ul><li>Check the box for <strong>&ldquo;Allow SSH traffic from&rdquo;</strong> and select <strong><code>My IP</code></strong>. This lets you securely log in.</li><li>Check <strong>&ldquo;Allow HTTPS traffic from the internet&rdquo;</strong> and <strong>&ldquo;Allow HTTP traffic from the internet&rdquo;</strong>. We&rsquo;ll need these for our secure dashboard later.</li></ul></li></ul></li><li><p><strong>Launch It!</strong> Hit the &ldquo;Launch instance&rdquo; button and watch as your new cloud server comes to life.</p></li><li><p><strong>Give Your Server a Permanent Address (Elastic IP):</strong></p><ul><li>By default, your server&rsquo;s public IP address will change every time it reboots. Let&rsquo;s make it permanent!</li><li>In the EC2 menu on the left, go to <strong>&ldquo;Elastic IPs&rdquo;</strong>.</li><li>Click <strong>&ldquo;Allocate Elastic IP address&rdquo;</strong> and then <strong>&ldquo;Allocate&rdquo;</strong>.</li><li>Select the new IP address from the list, click <strong>&ldquo;Actions&rdquo;</strong>, and then <strong>&ldquo;Associate Elastic IP address&rdquo;</strong>.</li><li>Choose your <code>AdGuard-Server</code> instance from the list and click <strong>&ldquo;Associate&rdquo;</strong>.</li><li>Your server now has a static IP address that will never change! Make a note of this new IP.</li></ul></li></ol><hr><h3 id=-chapter-2-opening-the-doors-configuring-the-firewall->## Chapter 2: Opening the Doors (Configuring the Firewall) üö™<a hidden class=anchor aria-hidden=true href=#-chapter-2-opening-the-doors-configuring-the-firewall->#</a></h3><p>Our server is running, but for maximum security, we want to ensure only <strong>you</strong> can access the administrative parts of it. We&rsquo;ll open the public DNS ports to everyone, but lock down the management ports to your home IP address.</p><ol><li><p><strong>Find Your Public IP Address:</strong> Open a new browser tab and go to a site like <a href=https://www.whatismyip.com/>WhatIsMyIP.com</a>. It will display your home&rsquo;s public IP address. Copy this IP address (it will look something like <code>203.0.113.55</code>).</p></li><li><p><strong>Edit the Firewall Rules:</strong> Go to your EC2 Instance details, click the <strong>&ldquo;Security&rdquo;</strong> tab, and click on the <strong>Security Group name</strong>.</p></li><li><p>Click <strong>&ldquo;Edit inbound rules&rdquo;</strong> and <strong>&ldquo;Add rule&rdquo;</strong> for each of the following. This makes sure your DNS is publicly available but the setup panel is locked down to your IP only.</p><ul><li><p><strong>Rule for AdGuard Setup (Port 3000):</strong></p><ul><li><strong>Type:</strong> <code>Custom TCP</code></li><li><strong>Port range:</strong> <code>3000</code></li><li><strong>Source:</strong> Paste your IP address here, and add <code>/32</code> to the end (e.g., <code>203.0.113.55/32</code>). The <code>/32</code> tells AWS it&rsquo;s a single, specific IP address.</li></ul></li><li><p><strong>Rule for DNS (Port 53):</strong></p><ul><li><strong>Type:</strong> <code>Custom UDP</code> and <code>Custom TCP</code> (you will add two separate rules for this port)</li><li><strong>Port range:</strong> <code>53</code></li><li><strong>Source:</strong> <code>Anywhere-IPv4</code></li></ul></li><li><p><strong>Rule for DNS-over-TLS (Port 853):</strong></p><ul><li><strong>Type:</strong> <code>Custom TCP</code></li><li><strong>Port range:</strong> <code>853</code></li><li><strong>Source:</strong> <code>Anywhere-IPv4</code></li></ul></li></ul></li><li><p>Click <strong>&ldquo;Save rules&rdquo;</strong>. Your firewall is now configured to allow public DNS requests while keeping your management panel secure.</p></li></ol><hr><h3 id=-chapter-3-installing-adguard-home->## Chapter 3: Installing AdGuard Home üõ°Ô∏è<a hidden class=anchor aria-hidden=true href=#-chapter-3-installing-adguard-home->#</a></h3><p>Now, let&rsquo;s connect to our server and install the magic software.</p><ol><li><strong>Connect via SSH:</strong> Open a terminal (PowerShell on Windows, Terminal on Mac/Linux) and use the key you downloaded to connect. <strong>Use your new Elastic IP address!</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Replace the path and Elastic IP with your own</span>
</span></span><span style=display:flex><span>ssh -i <span style=color:#e6db74>&#34;path/to/my-adguard-key.pem&#34;</span> admin@YOUR_ELASTIC_IP
</span></span></code></pre></div></li><li><strong>Install AdGuard Home:</strong> Run this one simple command. It downloads and installs everything for you.<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -s -S -L https://raw.githubusercontent.com/AdguardTeam/AdGuardHome/master/scripts/install.sh | sh -s -- -v
</span></span></code></pre></div></li><li><strong>Run the Setup Wizard:</strong> The script will give you a link, like <code>http://YOUR_ELASTIC_IP:3000</code>. Open this in your browser. Follow the on-screen steps to create your admin username and password.</li></ol><hr><h3 id=-chapter-4-teaching-your-guardian-who-to-trust-and-what-to-block>## Chapter 4: Teaching Your Guardian Who to Trust and What to Block<a hidden class=anchor aria-hidden=true href=#-chapter-4-teaching-your-guardian-who-to-trust-and-what-to-block>#</a></h3><p>With AdGuard Home installed, the next step is to configure its core brain: the DNS servers it gets its answers from and the blocklists it uses to protect your network.</p><h4 id=1-setting-up-upstream-dns-servers><strong>1. Setting Up Upstream DNS Servers</strong><a hidden class=anchor aria-hidden=true href=#1-setting-up-upstream-dns-servers>#</a></h4><p>Think of &ldquo;Upstream DNS Servers&rdquo; as the giant, public phonebooks of the internet. When your AdGuard server doesn&rsquo;t know an address (and it&rsquo;s not on a blocklist), it asks one of these upstreams. It&rsquo;s recommended to use a mix of the best encrypted DNS providers for security, privacy, and speed.</p><p>In the AdGuard dashboard, go to <strong>Settings -> DNS settings</strong>. In the <strong>&ldquo;Upstream DNS servers&rdquo;</strong> box, enter the following, one per line:</p><ul><li><a href=https://dns.quad9.net/dns-query>https://dns.quad9.net/dns-query</a></li><li><a href=https://dns.google/dns-query>https://dns.google/dns-query</a></li><li><a href=https://dns.cloudflare.com/dns-query>https://dns.cloudflare.com/dns-query</a></li></ul><ul><li><strong>Quad9:</strong> Focuses heavily on security, blocking malicious domains.</li><li><strong>Google:</strong> Known for being very fast.</li><li><strong>Cloudflare:</strong> A great all-around choice with a strong focus on privacy.</li></ul><h4 id=2-optimizing-dns-performance><strong>2. Optimizing DNS Performance</strong><a hidden class=anchor aria-hidden=true href=#2-optimizing-dns-performance>#</a></h4><p>Still in the <strong>DNS settings</strong> page, scroll down to optimize how your server queries the upstreams.</p><ul><li><p><strong>Parallel requests:</strong> Select this option. This is the fastest and most resilient mode. It sends your DNS query to all three of your upstream servers at the same time and uses the answer from the very first one that responds. This ensures you always get the quickest possible result.</p></li><li><p><strong>Enable EDNS client subnet (ECS):</strong> Check this box. This is very important for services like Netflix, YouTube, and other content delivery networks (CDNs). It helps them give you content from a server that is geographically closest to you, resulting in faster speeds and a better experience.</p></li></ul><h4 id=3-enabling-dnssec><strong>3. Enabling DNSSEC</strong><a hidden class=anchor aria-hidden=true href=#3-enabling-dnssec>#</a></h4><p>Right below the upstream servers, there&rsquo;s a checkbox for <strong>&ldquo;Enable DNSSEC&rdquo;</strong>. You should check this box. DNSSEC is like a digital wax seal on a letter; it verifies that the DNS answers you&rsquo;re getting are authentic and haven&rsquo;t been tampered with. It&rsquo;s a simple, one-click security boost.</p><h4 id=4-choosing-your-blocklists><strong>4. Choosing Your Blocklists</strong><a hidden class=anchor aria-hidden=true href=#4-choosing-your-blocklists>#</a></h4><p>This is the fun part‚Äîthe actual ad-blocking! Go to <strong>Filters -> DNS blocklists</strong>. For a &ldquo;Balanced & Powerful&rdquo; setup that blocks aggressively without a high risk of breaking websites, enable the following lists:</p><ul><li><strong>AdGuard DNS filter:</strong> A great, well-maintained baseline.</li><li><strong>OISD Blocklist Big:</strong> Widely considered one of the best all-in-one lists for blocking ads, trackers, and malware.</li><li><strong>HaGeZi&rsquo;s Pro Blocklist:</strong> A fantastic list that adds another layer of aggressive blocking for privacy.</li><li><strong>HaGeZi&rsquo;s Threat Intelligence Feed:</strong> A crucial security-only list that focuses on protecting against active threats like phishing and malware.</li></ul><p>This combination will give you robust protection against both annoyances and real dangers.</p><hr><h3 id=-chapter-5-giving-your-server-a-name-free-domain-with-no-ip->## Chapter 5: Giving Your Server a Name (Free Domain with No-IP) üìõ<a hidden class=anchor aria-hidden=true href=#-chapter-5-giving-your-server-a-name-free-domain-with-no-ip->#</a></h3><p>An IP address is hard to remember. Let&rsquo;s get a free, memorable name for our server.</p><ol><li><strong>Sign Up at No-IP:</strong> Go to <a href=https://www.noip.com/>No-IP.com</a>, create a free account, and create a <strong>hostname</strong> (e.g., <code>my-dns.ddns.net</code>).</li><li><strong>Point it to Your Server:</strong> When creating the hostname, enter your server&rsquo;s permanent <strong>Elastic IP address</strong>. Confirm your account via email.</li></ol><hr><h3 id=-chapter-6-making-it-secure-with-ssltls->## Chapter 6: Making It Secure with SSL/TLS üîê<a hidden class=anchor aria-hidden=true href=#-chapter-6-making-it-secure-with-ssltls->#</a></h3><p>We&rsquo;ll use <strong>Let&rsquo;s Encrypt</strong> and <strong>Certbot</strong> to get a free SSL certificate, which lets us use secure <code>https://</code> and encrypted DNS.</p><ol><li><p><strong>Install Certbot:</strong> In your SSH session, run these commands:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update
</span></span><span style=display:flex><span>sudo apt install certbot -y
</span></span></code></pre></div></li><li><p><strong>Get the Certificate:</strong> Run this command, replacing the email and domain with your own.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># This command will temporarily stop any service on port 80, get the certificate, and then finish.</span>
</span></span><span style=display:flex><span>sudo certbot certonly --standalone --agree-tos --email YOUR_EMAIL@example.com -d your-no-ip-hostname.ddns.net
</span></span></code></pre></div><p>If it&rsquo;s successful, it will tell you where your certificate files are saved (usually in <code>/etc/letsencrypt/live/your-no-ip-hostname.ddns.net/</code>).</p></li><li><p><strong>Configure AdGuard Home Encryption:</strong></p><ul><li>Go to your AdGuard Home dashboard (<strong>Settings -> Encryption settings</strong>).</li><li>Check <strong>&ldquo;Enable encryption&rdquo;</strong>.</li><li>In the <strong>&ldquo;Server name&rdquo;</strong> field, enter your No-IP hostname.</li><li>Under <strong>&ldquo;Certificates&rdquo;</strong>, choose <strong>&ldquo;Set a certificates file path&rdquo;</strong>.<ul><li><strong>Certificate path:</strong> <code>/etc/letsencrypt/live/your-no-ip-hostname.ddns.net/fullchain.pem</code></li><li><strong>Private key path:</strong> <code>/etc/letsencrypt/live/your-no-ip-hostname.ddns.net/privkey.pem</code></li></ul></li><li>Click <strong>&ldquo;Save configuration&rdquo;</strong>. The page will reload on a secure <code>https://</code> connection!</li></ul></li></ol><hr><h3 id=-chapter-7-automating-ssl-renewal-cron-job-magic->## Chapter 7: Automating SSL Renewal (Cron Job Magic) ‚ú®<a hidden class=anchor aria-hidden=true href=#-chapter-7-automating-ssl-renewal-cron-job-magic->#</a></h3><p>Let&rsquo;s Encrypt certificates last for 90 days. We can tell our server to automatically renew them.</p><ol><li><p><strong>Open Firewall (Port 80):</strong> Certbot <em>requires</em> <strong>port 80</strong> for its renewal challenge. We must add this <code>ufw</code> rule on our server, or the renewal will fail.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo ufw allow 80/tcp
</span></span></code></pre></div></li><li><p><strong>Open the Cron Editor:</strong> In SSH, run <code>sudo crontab -e</code> and choose <code>nano</code> as your editor.</p></li><li><p><strong>Add the Renewal Job:</strong> Add this line to the bottom of the file. It tells the server to try renewing the certificate every day at 2:30 AM.</p><pre tabindex=0><code>30 2 * * * certbot renew --quiet --pre-hook &#34;systemctl stop AdGuardHome.service&#34; --post-hook &#34;systemctl start AdGuardHome.service&#34;
</code></pre><p><strong>Note:</strong> The <code>--post-hook</code> is critical. It <em>guarantees</em> AdGuard Home restarts even if the renewal fails, which prevents a service outage.</p></li><li><p><strong>Save and exit</strong> (<code>Ctrl+X</code>, then <code>Y</code>, then <code>Enter</code>). Your server will now keep its certificate fresh forever!</p></li></ol><hr><h3 id=-chapter-8-testing-your-new-superpowers-doh--dot->## Chapter 8: Testing Your New Superpowers (DoH & DoT) üß™<a hidden class=anchor aria-hidden=true href=#-chapter-8-testing-your-new-superpowers-doh--dot->#</a></h3><p>For a direct confirmation, I used these commands on my computer:</p><ul><li><p><strong>DNS-over-HTTPS (DoH) Test:</strong> This test checks if the secure web endpoint for DNS is alive.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -v <span style=color:#f92672>[</span>https://your-no-ip-hostname.ddns.net/dns-query<span style=color:#f92672>](</span>https://your-no-ip-hostname.ddns.net/dns-query<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>I got a &ldquo;405 Method Not Allowed&rdquo; error, which sounds bad but is actually <strong>great news</strong>. It means I successfully connected to the server, which correctly told me I didn&rsquo;t send a real query. The connection works!</p></li><li><p><strong>DNS-over-TLS (DoT) Test:</strong> This checks the dedicated secure port for DNS. I used a tool called <code>kdig</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># I had to install it first with: sudo apt install knot-dnsutils</span>
</span></span><span style=display:flex><span>kdig @your-no-ip-hostname.ddns.net +tls-ca +tls-host<span style=color:#f92672>=</span>your-no-ip-hostname.ddns.net example.com
</span></span></code></pre></div><p>The command returned a perfect DNS answer for <code>example.com</code>, confirming the secure tunnel was working.</p></li></ul><hr><h3 id=-chapter-9-protecting-your-kingdom-router--phone-setup->## Chapter 9: Protecting Your Kingdom (Router & Phone Setup) üè∞<a hidden class=anchor aria-hidden=true href=#-chapter-9-protecting-your-kingdom-router--phone-setup->#</a></h3><p>Now, let&rsquo;s point your devices to their new guardian.</p><ul><li><strong>On Your Home Router:</strong> Log in to your router&rsquo;s admin page, find the DNS settings, and enter your server&rsquo;s <strong>Elastic IP</strong> as the primary DNS server. Leave the secondary field blank! This forces all devices on your Wi-Fi to be protected. Then, restart your router.</li><li><strong>On Your Mobile Phone:</strong><ul><li><strong>Android:</strong> Go to <strong>Settings -> Network -> Private DNS</strong>. Choose &ldquo;Private DNS provider hostname&rdquo; and enter your No-IP hostname (<code>my-dns.ddns.net</code>). This gives you ad-blocking everywhere, even on cellular data!</li><li><strong>iOS:</strong> You can use a profile to configure DoH. A simple way is to use a site like <a href=https://adguard-dns.io/en/public-dns.html>AdGuard&rsquo;s DNS profile generator</a>, but enter your own server&rsquo;s DoH address (<code>https://my-dns.ddns.net/dns-query</code>).</li></ul></li></ul><hr><h3 id=-chapter-10-the-ultimate-safety-net-creating-a-snapshot->## Chapter 10: The Ultimate Safety Net (Creating a Snapshot) üì∏<a hidden class=anchor aria-hidden=true href=#-chapter-10-the-ultimate-safety-net-creating-a-snapshot->#</a></h3><p>Finally, let&rsquo;s back up our perfect setup.</p><ol><li>In the EC2 Console, go to your instance details.</li><li>Click the <strong>&ldquo;Storage&rdquo;</strong> tab and click the <strong>&ldquo;Volume ID&rdquo;</strong>.</li><li>Click <strong>&ldquo;Actions&rdquo; -> &ldquo;Create snapshot&rdquo;</strong>.</li><li>Give it a description, like <code>AdGuard-Working-Setup-Backup</code>.</li></ol><p>If you ever mess something up, you can use this snapshot to restore your server to this exact working state in minutes.</p><h3 id=-bonus-chapter-common-troubleshooting-tips>## Bonus Chapter: Common Troubleshooting Tips<a hidden class=anchor aria-hidden=true href=#-bonus-chapter-common-troubleshooting-tips>#</a></h3><p>If things aren&rsquo;t working, here are a few common pitfalls to check:</p><ul><li><strong>Browser Overrides Everything:</strong> If one device isn&rsquo;t blocking ads, check its browser settings! Modern browsers like Chrome have a &ldquo;Secure DNS&rdquo; feature that can bypass your custom setup. You may need to turn this off.</li><li><strong>Check Your Laptop&rsquo;s DNS:</strong> Make sure your computer&rsquo;s network settings are set to &ldquo;Obtain DNS automatically&rdquo; so it listens to the router. A manually set DNS on your PC will ignore the router&rsquo;s settings.</li><li><strong>Beware of IPv6:</strong> If you run into trouble on one device, try disabling IPv6 in that device&rsquo;s Wi-Fi adapter properties to force it to use your working IPv4 setup.</li></ul><h3 id=-its-a-wrap>## It‚Äôs a Wrap!<a hidden class=anchor aria-hidden=true href=#-its-a-wrap>#</a></h3><p>And there you have it! You&rsquo;ve successfully built a personal, secure, ad-blocking DNS server in the cloud. You&rsquo;ve learned about cloud computing, firewalls, DNS, SSL, and automation. Go enjoy a faster, cleaner, and more private internet experience.</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/adguard-home/><span class=tech-badge>AdGuard Home</span></a></li><li><a href=http://localhost:1313/tags/self-hosting/><span class=tech-badge>Self-Hosting</span></a></li><li><a href=http://localhost:1313/tags/homelab/><span class=tech-badge>Homelab</span></a></li><li><a href=http://localhost:1313/tags/cloudcomputing/><span class=tech-badge>CloudComputing</span></a></li><li><a href=http://localhost:1313/tags/cloud/><span class=tech-badge>Cloud</span></a></li><li><a href=http://localhost:1313/tags/linux/><span class=tech-badge>Linux</span></a></li><li><a href=http://localhost:1313/tags/aws/><span class=tech-badge>AWS</span></a></li><li><a href=http://localhost:1313/tags/ec2/><span class=tech-badge>EC2</span></a></li><li><a href=http://localhost:1313/tags/firewall/><span class=tech-badge>Firewall</span></a></li><li><a href=http://localhost:1313/tags/elastic-ip/><span class=tech-badge>Elastic IP</span></a></li><li><a href=http://localhost:1313/tags/letsencrypt/><span class=tech-badge>LetsEncrypt</span></a></li><li><a href=http://localhost:1313/tags/certbot/><span class=tech-badge>Certbot</span></a></li><li><a href=http://localhost:1313/tags/debian/><span class=tech-badge>Debian</span></a></li><li><a href=http://localhost:1313/tags/no-ip/><span class=tech-badge>No-IP</span></a></li><li><a href=http://localhost:1313/tags/ssl/><span class=tech-badge>SSL</span></a></li><li><a href=http://localhost:1313/tags/tls/><span class=tech-badge>TLS</span></a></li><li><a href=http://localhost:1313/tags/cron/><span class=tech-badge>Cron</span></a></li><li><a href=http://localhost:1313/tags/dns/><span class=tech-badge>DNS</span></a></li><li><a href=http://localhost:1313/tags/dnssec/><span class=tech-badge>DNSSEC</span></a></li><li><a href=http://localhost:1313/tags/opensource/><span class=tech-badge>Opensource</span></a></li><li><a href=http://localhost:1313/tags/doh/><span class=tech-badge>DoH</span></a></li><li><a href=http://localhost:1313/tags/dot/><span class=tech-badge>DoT</span></a></li></ul><div class=social-icons><a target=_blank rel="noopener noreferrer" aria-label="share How I Built My Own Ad-Blocking DNS Server in the Cloud (Updated AWS Edition!) on twitter" href="https://twitter.com/intent/tweet/?text=How%20I%20Built%20My%20Own%20Ad-Blocking%20DNS%20Server%20in%20the%20Cloud%20%28Updated%20AWS%20Edition%21%29&amp;url=http%3a%2f%2flocalhost%3a1313%2fprojects%2fadguard-updated%2f&amp;hashtags=AdGuardHome%2cSelf-Hosting%2cHomelab%2cCloudComputing%2cCloud%2cLinux%2cAWS%2cEC2%2cFirewall%2cElasticIP%2cLetsEncrypt%2cCertbot%2cDebian%2cNo-IP%2cSSL%2cTLS%2cCron%2cDNS%2cDoH%2cDoT%2cDNSSEC%2cOpensource%2cDoH%2cDoT"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share How I Built My Own Ad-Blocking DNS Server in the Cloud (Updated AWS Edition!) on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fprojects%2fadguard-updated%2f&amp;title=How%20I%20Built%20My%20Own%20Ad-Blocking%20DNS%20Server%20in%20the%20Cloud%20%28Updated%20AWS%20Edition%21%29&amp;summary=How%20I%20Built%20My%20Own%20Ad-Blocking%20DNS%20Server%20in%20the%20Cloud%20%28Updated%20AWS%20Edition%21%29&amp;source=http%3a%2f%2flocalhost%3a1313%2fprojects%2fadguard-updated%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share How I Built My Own Ad-Blocking DNS Server in the Cloud (Updated AWS Edition!) on reddit" href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fprojects%2fadguard-updated%2f&title=How%20I%20Built%20My%20Own%20Ad-Blocking%20DNS%20Server%20in%20the%20Cloud%20%28Updated%20AWS%20Edition%21%29"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share How I Built My Own Ad-Blocking DNS Server in the Cloud (Updated AWS Edition!) on facebook" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fprojects%2fadguard-updated%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share How I Built My Own Ad-Blocking DNS Server in the Cloud (Updated AWS Edition!) on whatsapp" href="https://api.whatsapp.com/send?text=How%20I%20Built%20My%20Own%20Ad-Blocking%20DNS%20Server%20in%20the%20Cloud%20%28Updated%20AWS%20Edition%21%29%20-%20http%3a%2f%2flocalhost%3a1313%2fprojects%2fadguard-updated%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share How I Built My Own Ad-Blocking DNS Server in the Cloud (Updated AWS Edition!) on telegram" href="https://telegram.me/share/url?text=How%20I%20Built%20My%20Own%20Ad-Blocking%20DNS%20Server%20in%20the%20Cloud%20%28Updated%20AWS%20Edition%21%29&amp;url=http%3a%2f%2flocalhost%3a1313%2fprojects%2fadguard-updated%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>Prajwol Bikram Adhikari</a> ¬∑ <a href=/%20/privacy-policy/>Privacy Policy</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>